<!DOCTYPE html>
<html lang="en-us">

<head>
	<%include ../header%>
</head>

<body class="layout layout-vertical layout-left-navigation layout-above-toolbar layout-above-footer">
        <main>
       <div id="wrapper">
            <%include ../sidebar%>
           <%include editorderdialog%>
	
          <div class="content-wrapper">
                <div class="content custom-scrollbar ps ps--active-y">
                    <div >
                   
						<!-- / body -->
						<div class="container-fluid">
							<div class="row">
								
								<div class="col-12">
									<!-- Title of table -->
									<div class="row align-items-center my-table-title">
											<div class="col">
												<div>
													<a href="#" ><h3 class="mycustom-title">Danh sách hóa đơn</h3></a>
												</div>
												
											</div>

											<div class="col-auto">
												<div class="row align-items-center justify-content-end">		
													<div class="user-menu-button">
													<!-- 	<div>
															<button onclick="pp(id)" type="button" class="btn btn-primary my-button"data-toggle="modal" data-target="#my-order-dialog-new">Thêm mới</button>

														</div> -->
													</div>
												</div>
											</div>
									</div>
								
									<form class="my-form-table">
									<!-- Table -->
										
									<table id="my-table" class="table table-striped table-bordered">
													<thead class="my-title-table">
												<tr>
													<th>Mã Hóa đơn</th>
													<th>Ngày mua</th>
													<th>Người mua</th>
													<th>Tổng Tiền</th>
													<th>Trạng thái</th>
													<!-- <th>Xem chi tiết</th> -->
													<th>Chỉnh Sửa</th>
												</tr>
											</thead>
												<tbody class="my-table-body">															<% orders.forEach(function(data,i){ %>

														<tr>
															<th><%=data.OrderNumber%></th>
													<th><%=data.NgayMua%></th>
													<th><%=data.UserID%></th>
													<th><%=data.TotalAmount%></th>
													<th><%=data.state%></th>
													   <!-- <td><button type="button" class="my-table-btn btn btn-primary">Chi tiết</button></td>
													   -->
													   <td><button type="button" id="<%=data._id%>" class="btn btn-primary my-button"data-toggle="modal"onclick="pp(id)" data-target="#my-order-dialog-edit">Cập nhật</button></td>
													</tr>
														
													<%})%>
													
												</tbody>

											</table>
											<script>
												$(document).ready(function() {
													$('#my-table').DataTable({    
														"aLengthMenu": [[5, 10, 25, -1], [5, 10, 25, "All"]],
														"iDisplayLength": 5
													});
												});

												function pp(dd){
															$.ajax({
													        url: '/admin/orders',
													        method: 'post',
													    	data: {
										                    id : dd
										              		},
										                timeout: 5000,
										                complete: function() {
										                  //called when complete
										                  console.log('process complete');
										                },

										                success: function(data) {
										                  console.log(data._id);
										                  console.log('process sucess');
										                  
										                  $('#new-order-state').attr('value',data.state);
										                  $('#new-order-ordernumber').attr('value',data.OrderNumber);
										                  
										               },

										                error: function() {
										                  console.log('process error');
										                },
										              });}
										</script>

									</form>
								</div>
							</div>
						</div>
						<!-- enđ body --> 
                    

                <!-- <div class="ps__rail-x" style="left: 0px; bottom: 0px;"><div class="ps__thumb-x" tabindex="0" style="left: 0px; width: 0px;"></div></div><div class="ps__rail-y" style="top: 0px; height: 471px; right: 0px;"><div class="ps__thumb-y" tabindex="0" style="top: 0px; height: 325px;"></div></div></div> -->
            </div>
		</div>
    </main>
</body>

</body>
</body>

</html>